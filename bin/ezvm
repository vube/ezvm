#!/bin/bash
#
# Easy VM (ezvm)
#
# See ../commands/USAGE.txt for usage information
#

if [ -z "$EZVM_BASE_DIR" ]; then
    # EZVM_BASE_DIR is ..
    bindir="$($(dirname "$0")/realpath "$0")"
    export EZVM_BASE_DIR="$(dirname $(dirname "$bindir"))"
fi

# Slurp up some useful libs
. $EZVM_BASE_DIR/libs/settings.sh
. $EZVM_BASE_DIR/libs/log.sh
. $EZVM_BASE_DIR/libs/common.sh
. $EZVM_BASE_DIR/libs/sudo.sh
. $EZVM_BASE_DIR/libs/usage.sh

# USAGE.txt filename
USAGE_FILE="$EZVM_COMMANDS_DIR/USAGE.txt"


command=$1

case "$command" in

    selfupdate|update|exec)

        shift # Remove command from arguments list

        script="$EZVM_COMMANDS_DIR/$command.sh"
        if [ -r $script ]; then
            USAGE_FILE="$EZVM_COMMANDS_DIR/USAGE-$command.txt"
            . $script
        else
            die "No such command: $script"
        fi
        ;;

    help|*)
        printUsageAndExit ;;
esac
