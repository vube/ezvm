#!/bin/bash
#
# Easy VM (ezvm)
#
# See ../commands/USAGE.txt for usage information
#

export EZVM_VERBOSITY=${EZVM_VERBOSITY:-1}

# EZVM_BASE_DIR is ..
export EZVM_BASE_DIR="$(dirname $(dirname $0))"

export EZVM_BIN_DIR="$EZVM_BASE_DIR/bin"
export EZVM_COMMANDS_DIR="$EZVM_BASE_DIR/commands"
export EZVM_ETC_DIR="$EZVM_BASE_DIR/etc"

# USAGE.txt filename
USAGE_FILE="$EZVM_COMMANDS_DIR/USAGE.txt"

# Slurp up some useful libs
. $EZVM_COMMANDS_DIR/libs/log.sh
. $EZVM_COMMANDS_DIR/libs/usage.sh


command=$1

case "$command" in

    selfupdate|update)

        shift # Remove command from arguments list

        script="$EZVM_COMMANDS_DIR/$command.sh"
        if [ -r $script ]; then
            USAGE_FILE="$EZVM_COMMANDS_DIR/USAGE-$command.txt"
            . $script
        else
            echo "ERROR: No such command: $script" 1>&2
            exit 2
        fi
        ;;

    help|*)
        printUsageAndExit ;;
esac
